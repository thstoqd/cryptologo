# 手动触发 GitHub Actions Workflow 指南

## 🚀 步骤详解

### 步骤 1: 进入 GitHub Actions 页面

1. **打开你的 GitHub 仓库**
   - 访问: `https://github.com/thstoqd/cryptologo`
   - 或者直接在浏览器中打开你的仓库

2. **点击 "Actions" 标签页**
   - 在仓库顶部导航栏中
   - 位于 "Pull requests" 和 "Projects" 之间

### 步骤 2: 找到 "更新代币排名" Workflow

1. **在左侧边栏找到 workflow**
   - 左侧会显示 "All workflows" 和各个 workflow 列表
   - 找到 **"更新代币排名"** workflow
   - 点击它

2. **或者从运行历史中找到**
   - 在 "All workflows" 页面
   - 找到最近的 "更新代币排名" 运行记录
   - 点击 workflow 名称

### 步骤 3: 手动触发 Workflow

1. **找到 "Run workflow" 按钮**
   - 在 workflow 页面右上角
   - 会显示一个绿色的 **"Run workflow"** 按钮
   - 旁边可能有一个下拉箭头

2. **点击 "Run workflow"**
   - 点击按钮后会展开一个菜单
   - 选择要运行的分支（通常是 `main` 或 `master`）
   - 点击 **"Run workflow"** 按钮确认

3. **等待运行开始**
   - 页面会自动刷新
   - 你会看到一个新的运行记录出现在列表顶部
   - 状态会显示为 "Queued"（排队中）或 "In progress"（运行中）

### 步骤 4: 查看运行日志

1. **点击新创建的运行记录**
   - 在运行列表中，点击最新的运行（通常是 #17 或更高）

2. **查看运行步骤**
   - 左侧会显示所有步骤：
     - ✅ 检出代码
     - ✅ 设置 Node.js
     - ✅ 安装依赖
     - ⏳ 更新代币排名（正在运行）
     - ⏸️ 检查是否有更改
     - ⏸️ 提交更改
     - ⏸️ 输出结果

3. **点击步骤查看详细日志**
   - 点击 "更新代币排名" 步骤
   - 查看详细输出：
     - 是否显示 "✅ API Key 已设置"
     - 是否有错误信息
     - API 调用是否成功

## 📊 查看运行状态

### 成功标志 ✅

- 所有步骤显示绿色 ✓
- 看到 "✅ 更改已成功提交并推送"
- 或者看到 "没有排名更新，跳过提交"（这也是正常的）

### 失败标志 ❌

- 某个步骤显示红色 ✗
- 点击失败的步骤查看错误信息：
  - **"❌ 错误: COINMARKETCAP_API_KEY 未设置"** → Secret 配置问题
  - **"API 错误 401"** → API Key 无效
  - **"网络请求失败"** → 网络问题
  - **"❌ 推送失败"** → 权限问题

## 🔍 关键日志检查点

### 1. API Key 验证

查找日志中的这一行：
```
✅ API Key 已设置（前10字符: xxxxx...）
```

如果看到：
- ✅ **"✅ API Key 已设置"** → API Key 配置正确
- ❌ **"❌ 错误: COINMARKETCAP_API_KEY 未设置"** → Secret 未配置或名称错误

### 2. API 调用结果

查找日志中的这些信息：
```
正在连接 CoinMarketCap API...
收到响应: 200 OK
✅ 成功获取 XXX 个代币的排名数据
```

如果看到：
- ✅ **"200 OK"** → API 调用成功
- ❌ **"401 Unauthorized"** → API Key 无效
- ❌ **"429 Too Many Requests"** → API 调用超限

### 3. 更新结果

查找日志中的这些信息：
```
更新完成!
- 成功更新: X 个代币
- 未找到排名: X 个代币
```

### 4. 提交结果

查找日志中的这些信息：
```
✅ 更改已成功提交并推送
```

或者：
```
没有排名更新，跳过提交
```

## 🎯 快速操作路径

```
GitHub 仓库首页
  → 点击 "Actions" 标签
    → 左侧找到 "更新代币排名"
      → 点击右上角 "Run workflow"
        → 选择分支 "main"
          → 点击 "Run workflow" 确认
            → 等待运行完成
              → 点击运行记录查看日志
```

## ⚠️ 注意事项

1. **运行需要时间**
   - 通常需要 1-3 分钟
   - 如果 API 调用慢，可能需要更长时间

2. **不要频繁触发**
   - 避免短时间内多次触发
   - 可能会触发 API 限流

3. **查看完整日志**
   - 如果失败，点击失败的步骤
   - 查看完整的错误信息
   - 截图保存以便排查

## 📸 如果找不到按钮

如果看不到 "Run workflow" 按钮，可能的原因：

1. **Workflow 文件有问题**
   - 检查 `.github/workflows/update-ranks.yml` 是否存在
   - 确认文件中有 `workflow_dispatch:` 配置

2. **权限问题**
   - 确认你有仓库的写入权限
   - 如果是 fork，需要在原仓库触发

3. **浏览器缓存**
   - 刷新页面（Ctrl+F5 或 Cmd+Shift+R）
   - 清除浏览器缓存

## 🆘 需要帮助？

如果遇到问题：

1. **截图运行日志**（隐藏敏感信息）
2. **检查错误信息**的具体内容
3. **确认 Secret 配置**是否正确
4. **验证 API Key**是否有效

